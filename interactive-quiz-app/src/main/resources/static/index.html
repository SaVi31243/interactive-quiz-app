<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ —Ç–µ—Å—Ç–∏</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!</h1>
    <a href="pages/admin.html">[Admin] –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç</a><br>
    <a href="pages/quiz.html">[User] –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç</a>
</body>
<title>–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–µ—Å—Ç–∞–º–∏</title>
<style>
    body {
        font-family: sans-serif;
        padding: 20px;
    }

    .test {
        border: 1px solid #ccc;
        padding: 10px;
        margin-bottom: 10px;
    }

    input,
    textarea {
        display: block;
        margin: 5px 0;
        width: 100%;
    }

    button {
        margin-top: 5px;
    }
</style>
</head>

<body>
    <h1>–°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç—ñ–≤</h1>
    <div id="testList"></div>
    <script>
        async function fetchTests() {
            const res = await fetch("http://localhost:8080/api/tests",)
            const tests = await res.json();
            renderTests(tests);
        }

        function renderTests(tests) {
            const container = document.getElementById("testList");
            container.innerHTML = "";

            tests.forEach(test => {
                const div = document.createElement("div");
                div.className = "test";
                div.innerHTML = `
          <input type="text" id="title-${test.id}" value="${test.title}" />
          <textarea id="desc-${test.id}">${test.description}</textarea>
          <button onclick="updateTest(${test.id})">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
          <button onclick="deleteTest(${test.id})">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
        `;
                container.appendChild(div);
            });
        }

        async function updateTest(id) {
            const title = document.getElementById(`title-${id}`).value;
            const description = document.getElementById(`desc-${id}`).value;

            const res = await fetch(`http://localhost:8080/api/tests/${id}`, {
                method: "PUT",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Basic " + btoa("admin:admin123")
                },
                body: JSON.stringify({ title, description })
            });

            if (res.ok) {
                alert("‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–æ");
            } else {
                alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è");
            }
        }

        async function deleteTest(id) {
            const confirmDelete = confirm("–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ—Å—Ç?");
            if (!confirmDelete) return;

            const res = await fetch(`http://localhost:8080/api/tests/${id}`, {
                method: "DELETE",
                headers: {
                    "Authorization": "Basic " + btoa("admin:admin123")
                }
            });

            if (res.ok) {
                alert("üóëÔ∏è –í–∏–¥–∞–ª–µ–Ω–æ");
                fetchTests();
            } else {
                alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è");
            }
        }

        fetchTests();
    </script>
</body>

</html>